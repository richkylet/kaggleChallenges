function busy(regionSelector){$("input ",regionSelector).attr("disabled","disabled"),$("button",regionSelector).attr("disabled","disabled"),$("select",regionSelector).attr("disabled","disabled"),$.each($("a",regionSelector),function(index,item){$(item).attr("data-ng-click")||$(item).attr("disabled","disabled").data("href",$(item).attr("href")).attr("href","javascript:void(0)")})}function ready(regionSelector){$("input",regionSelector).removeAttr("disabled"),$("button",regionSelector).removeAttr("disabled"),$("select",regionSelector).removeAttr("disabled"),$.each($("a",regionSelector),function(index,item){$(item).attr("data-ng-click")||$(item).removeAttr("disabled").attr("href",$(item).data("href"))})}angular.module("masterModule").directive("tssFooter",[function(){"use strict";return{restrict:"E",templateUrl:"/tsc/partials/footer.html"}}]),angular.module("masterModule").service("cloudService",["$rootScope","$location","$q","$http",function($rootScope,$location,$q,$http){function getCsrfToken(config){return config.headers["X-XSRF-TOKEN"]}function getCsrfTokenFromCookie(){var responseCsrf,responseCookies=document.cookie.split(";");return responseCookies.forEach(function(cookie){if(cookie.indexOf("XSRF-TOKEN")>0){var xsrfKeyValue=cookie.split("=");xsrfKeyValue.length>0&&(responseCsrf=xsrfKeyValue[1])}}),responseCsrf}var my=this,checkSessionTimeout=function(tssUser){my.getCurrentUser.then(function(currentUser){var guestUser="guest@ANONYMOUS";tssUser=tssUser?tssUser:guestUser,currentUser.loggedIn&&(tssUser==guestUser?window.location=currentUser.features.desktop.enabled?"http://spotfire.tibco.com/?sessionEnd":"/spotfire/login.html":tssUser!=currentUser.loginName&&logOff(null,!1))})},setCurrentUser=function(currentUser){window.currentUser=currentUser;var currentUserTask=$q.defer();return currentUserTask.resolve(currentUser),my.getCurrentUser=currentUserTask.promise,currentUserTask},notifyChange=function(){$rootScope.$broadcast("currentUserUpdated"),$rootScope.$broadcast("notifyHeaderChanges")},coreApiCallPromise=function(url,data){var generateHttp=function(config){return $http(config).then(function(response){return response},function(rejection){var status=rejection.status;if(403===status){var requestCsrf=getCsrfToken(rejection.config),responseCsrf=getCsrfTokenFromCookie();return requestCsrf&&responseCsrf&&requestCsrf==responseCsrf?$q.reject(rejection):(rejection.config.headers["X-XSRF-TOKEN"]=responseCsrf,generateHttp(rejection.config))}return $q.reject(rejection)})};return generateHttp({url:url,data:data||{},dataType:"json",method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"}})},apiCallPromise=function(url,data){return coreApiCallPromise(url,data).then(function(response){checkSessionTimeout(response.headers("X-Current-User"));var responseData=response.data||{},responseDataD=responseData.d||{};return responseDataD.currentUser&&(setCurrentUser(responseData.d.currentUser),notifyChange()),responseDataD},function(response){var tssUser=response.headers("X-Current-User");tssUser&&checkSessionTimeout(tssUser);var result=response.data,message=""+(result.Message||result.message||result.result||result.d&&(result.d.response||result.d.result||result.d.message||result.d.Message)||("string"==typeof result?result:"System Error")),error=message.replace("@@","");return $q.reject({error:error,status:response.status,code:result.d.Code})})},logOff=function(){apiCallPromise("/spotfire/tsc/webservices/logoff")};this.logOff=logOff,this.newApiCall=apiCallPromise,this.fetchCurrentUser=function(){var fetch=$q.defer();return coreApiCallPromise("/spotfire/tsc/webservices/getcurrentuser").then(function(response){var headers=response.headers,data=response.data;checkSessionTimeout(headers("X-Current-User"));var currentUser=data.d.currentUser;setCurrentUser(currentUser),fetch.resolve(currentUser)},function(response){var headers=response.headers;checkSessionTimeout(headers("X-Current-User")),fetch.reject()}),fetch.promise};var legacyApiCall=function(param){return apiCallPromise(param.url,param.data).then(function(result){param.success({d:result})},param.error)};this.legacyApiCall=legacyApiCall;var forceSessionTimeoutCheck=function(){apiCallPromise("/spotfire/tsc/webservices/whoami",{}).then()};$(window).focus(function(){my.getCurrentUser.then(function(currentUser){currentUser&&currentUser.loggedIn&&forceSessionTimeoutCheck()})}),this.getCurrentUser=this.fetchCurrentUser(),this.findProduct=function(productId){return this.getCurrentUser.then(function(currentUser){for(var products=currentUser.products,i=0;i<products.length;i++){var product=products[i];if(product.productId==productId)return product}})}}]),angular.module("masterModule").factory("cloudHelpers",function(){function getName(user){var result=user.firstname;return result+=user.lastname?" "+user.lastname:"",""==result?user.loginName:result}function isAnalyst(currentUser){return currentUser&&currentUser.features&&currentUser.features.download?currentUser.features.homefolder&&!currentUser.features.homefolder.enabled?!1:!0:!1}function analyticsEvent(eventName,data){if(window.analyticsDataLayer){var gtmEvent={event:"spotfire"+eventName};data&&(gtmEvent.spotfireEventData=data),window.analyticsDataLayer.push(gtmEvent)}}return{analyticsEvent:analyticsEvent,getName:getName,isAnalyst:isAnalyst,getCookie:function(cookieName){var cookieValue=document.cookie,start=cookieValue.indexOf(" "+cookieName+"=");if(-1==start&&(start=cookieValue.indexOf(cookieName+"=")),-1==start)cookieValue=null;else{start=cookieValue.indexOf("=",start)+1;var end=cookieValue.indexOf(";",start);-1==end&&(end=cookieValue.length),cookieValue=unescape(cookieValue.substring(start,end))}return cookieValue?cookieValue:null}}}),angular.module("masterModule").service("notificationService",["$q","$sce","$http",function($q,$sce,$http){var notificationPromise=$q.defer();$http.get("/tsc/maintenance-message.js").success(function(data){var untrustedMessages=data.notifications||[];notificationPromise.resolve(untrustedMessages)}).error(function(){notificationPromise.resolve([])}),this.getNotifications=notificationPromise.promise}]),angular.module("masterModule").directive("notificationArea",[function(){"use strict";return{restrict:"E",templateUrl:"/tsc/partials/notification-area.html",controller:function($q,$sce,$scope,notificationService,cloudHelpers,cloudService){var currentUserPromise=cloudService.getCurrentUser,notificationPromise=notificationService.getNotifications;$q.all([currentUserPromise,notificationPromise]).then(function(results){function getCookieName(label,index){return currentUser.loginName+"-"+label+"-"+index}function getNotificationCookieName(index){return getCookieName("notification",index)}function getTrialMessageCookieName(index){return getCookieName("trialNotification",index)}var currentUser=results[0],notifications=results[1];$scope.currentUser=currentUser,$scope.showTrialMessage=function(id){return null==cloudHelpers.getCookie(getTrialMessageCookieName(id))?!0:!1},$scope.hideTrialMessage=function(item){var productId=item.product.productId,notificationLabel=getTrialMessageCookieName(productId);$("#"+notificationLabel).fadeOut("slow"),document.cookie=notificationLabel+"=closed;path=/;domain="+window.location.hostname},$scope.showTrialJumbotron=function(){var purchasedProduct=!1;if(currentUser&&currentUser.products&&currentUser.email)if(/^[A-Za-z0-9._%+-]+@tibco+\.com$/.test(currentUser.email))purchasedProduct=!0;else{var productIndex,products=currentUser.products;for(productIndex in products){var product=products[productIndex];if(product.active&&product.pay&&product.daysLeft>0){purchasedProduct=!0;break}}}return!purchasedProduct},$scope.notifications=notifications,$scope.hideNotification=function(item){var notificationId=item.notification.id,notificationLabel=getNotificationCookieName(notificationId);document.cookie=notificationLabel+"=closed;path=/;domain="+window.location.hostname},$scope.showNotification=function(id){return null==cloudHelpers.getCookie(getNotificationCookieName(id))?!0:!1}})}}}]),angular.module("masterModule").filter("unsafe",["$sce",function($sce){return $sce.trustAsHtml}]),angular.module("masterModule").config(["$routeProvider",function($routeProvider){$routeProvider.when("/share",{templateUrl:"/tsc/partials/share.html",controller:"LibraryCtrl"})}]),angular.module("masterModule").factory("customizationFactory",["cloudService","boldchatService","cloudHelpers","$q","configHttp","appConfigHandler","currentUserHandler",function(cloudService,boldchatService,cloudHelpers,$q,configHttp,appConfigHandler,currentUserHandler){function modifyConfig(){var config=appConfigHandler.get(),currentCloudUser=currentUserHandler.get();config.currentCloudUser=currentCloudUser;var cloudfeatures=currentCloudUser.features,desktopuser=cloudfeatures.desktop;if(config.IsDesktopUser=desktopuser.enabled,config.libraryBrowser={enableFeature:{button_copy:!0,button_delete:!0,button_more:!0,button_play:!0,button_rename:!0,column_modifiedby:!1}},currentCloudUser.features.homefolder.enabled&&(config.libraryBrowser.defaultFolder=currentCloudUser.features.homefolder.id),config.currentUser&&(config.currentUser.displayName=cloudHelpers.getName(currentCloudUser)),config.cloud={forgotCredentialsLink:"/tsc/#!/forgotpassword",signUpLink:"/tsc/#!/tryspotfire",learnMoreLink:"http://spotfire.tibco.com/buynow"},config.logo=config.logo||{},config.logo.href=currentCloudUser.homeFolderUrl,config.logo.attrs=[{key:"data-analytics-on",value:"click"},{key:"data-analytics-event",value:"Logo Clicked"}],!currentCloudUser.loggedIn||config.IsDesktopUser)config.appDrawer={title:"",enableAppDrawerDropdown:!1,showAppDrawerTitle:!1};else{var analyticsApp=config.accessibleApps.filter(function(app){return"analytics"===app.id})[0];analyticsApp&&(analyticsApp.path=currentCloudUser.homeFolderUrl),config.dropdownOnlyApps.push({path:"/tsc/#!/myaccount",appDrawerStyle:"header-app-card-small--account",id:"myaccount",name:"Account settings",notify:"false"});var pathname=window.location.pathname;0==pathname.indexOf("/tsc/")&&(config.appDrawer={title:"Account settings",enableAppDrawerDropdown:!0,showAppDrawerTitle:!0})}config.aboutItems=[{text:"User's guide",attribute:'data-analytics-on="click" data-analytics-event="User Guide" ng-hide="config.IsDesktopUser" target-blank ng-href="{{config.currentCloudUser.features.userguide.url}}"'},{text:"Quick start guide",attribute:'data-analytics-on="click" data-analytics-event="Quick Start Guide" target-blank ng-show="config.IsDesktopUser" href="http://spotfire.tibco.com/learn/spotfire-desktop-quickstart"'},{text:"Quick start guide",attribute:'data-analytics-on="click" data-analytics-event="Quick Start Guide" target-blank ng-show="!config.IsDesktopUser" href="http://spotfire.tibco.com/learn/spotfire-cloud-quickstart/"'},{text:"What's new",attribute:'data-analytics-on="click" data-analytics-event="Whats New" target-blank ng-hide="config.IsDesktopUser" href="http://spotfire.tibco.com/products/spotfire-cloud/whats-new"'},{text:"Documentation",attribute:'data-analytics-on="click" data-analytics-event="Document" target-blank ng-show="config.IsDesktopUser" href="https://docs.tibco.com/pub/spotfire/6.5.0/doc/html/index.htm"'},{text:"Chat with us",attribute:'data-analytics-on="click" data-analytics-event="Open Chat" ng-click="config.openBoldChat()"'},{text:"Support",attribute:'target-blank href="https://formvine.tibco.com/fv/r/9526489240/3346"'}],cloudHelpers.isAnalyst(currentCloudUser)&&config.aboutItems.push({text:"Welcome page",attribute:'data-analytics-on="click" data-analytics-event="Open welcome page" href="/tsc/#!/welcomepage"'});var logOutItem=config.accountItems.filter(function(app){return"logOutItem"===app.id})[0];config.accountItems=[{text:"Account settings",attribute:'data-analytics-on="click" data-analytics-event="My Profile" href="/tsc/#!/myaccount" ng-show="config.currentCloudUser.loggedIn"'},logOutItem],config.openBoldChat=boldchatService.openBoldChat,config.showDownload=function(){return cloudService.showDownload()},config.libraryBrowser.tab={id:"share",href:"#/share",label:"Shared folders",tooltip:"Share selected folders with others",show:currentCloudUser.loggedIn}}return modifyConfig(),{config:function(){return appConfigHandler.get()},refreshConfig:function(){var configPromise=configHttp.getHeaderConfig().$promise,cloudPromise=cloudService.fetchCurrentUser(),combinedPromise=$q.all([configPromise,cloudPromise]).then(function(results){var newConfig=results[0],newCurrentUser=results[1];appConfigHandler.set(newConfig),currentUserHandler.set(newCurrentUser),modifyConfig()});return combinedPromise},libraryConfig:function(){return{search:!1,column_modifiedby:!1}},appDropDownNameMappings:function(){return[{id:"welcomepage",name:"Menu"},{id:"subscriptions",name:"Account settings"},{id:"paymenthistory",name:"Account settings"},{id:"downloads",name:"Account settings"},{id:"myteam",name:"Account settings"},{id:"subscriptions",name:"Account settings"},{id:"manageusers",name:"Account settings"}]}}}]),angular.module("masterModule").service("boldchatService",["cloudService",function(cloudService){var boldChatInit=function(currentUser){function getSubscriptionName(){var flag=" ";for(var ix in currentUser.products){var product=currentUser.products[ix];if(product.active===!0&&"Expired"!=product.status){flag=product.productName+", status: "+product.status+", expires on: "+product.expirationDate;break}}return flag}var bcArgs=[],productName=getSubscriptionName(),userName=currentUser.firstname+" "+currentUser.lastname,userEmail=currentUser.email,userPhone="",userref="";return bcArgs.push(["setAccountID","302171757299270789"]),bcArgs.push(["setParameter","WebsiteDefID",currentUser.features.boldchat.WebsiteDefID]),bcArgs.push(["setParameter","InvitationDefID",currentUser.features.boldchat.InvitationDefID]),bcArgs.push(["setParameter","VisitName",userName]),bcArgs.push(["setParameter","VisitPhone",userPhone]),bcArgs.push(["setParameter","VisitEmail",currentUser.email]),bcArgs.push(["setParameter","VisitRef",userref]),bcArgs.push(["setParameter","VisitInfo",productName]),bcArgs.push(["setParameter","CustomUrl",""]),bcArgs.push(["setParameter","WindowParameters","vr=&vi="+productName+"&ve="+userEmail+"&vp=&vn="+userName+"&lc="]),bcArgs.push(["addFloat",{type:"chat",id:currentUser.features.boldchat.chatId}]),bcArgs.push(["pageViewed"]),bcArgs};this.openBoldChat=function(){var elem=$(".bcFloat a");elem.click()},window.openBoldChat=this.openBoldChat;var pathname=location.pathname;0!=pathname.indexOf("/spotfire/wp/render")&&cloudService.getCurrentUser.then(function(currentUser){window._bcvma=boldChatInit(currentUser);var url="https://vmss.boldchat.com/aid/302171757299270789/bc.vms4/vms.js",head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.src=url,head.appendChild(script)})}]),angular.module("masterModule").directive("targetBlank",function(){return{compile:function(element){var elems="A"===element.prop("tagName")?element:element.find("a");elems.attr("target","_blank")}}}),angular.module("masterModule").factory("userFolder",["$q","$rootScope","cloudService",function($q,$rootScope,cloudService){var newApiCall=cloudService.newApiCall,userFolder={},showError=function(response){var error=response.error,status=response.status;return ready("body"),$("#error_response").html(error),$("#error_response_code").html(status),$("#errorModal").modal("show"),$q.reject(response)},showErrorIfLoaded=function(response){return $rootScope.isLoaded&&$("#myTabContent tbody tr:first").hide(),showError(response)};return userFolder.getHomeFolder=function(){window.open(currentUser.homeFolderUrl)},userFolder.getWorkGroupFolder=function(){window.open(currentUser.workgroupFolderUrl)},userFolder.getMyFolders=function(){return newApiCall("/spotfire/tsc/webservices/getmyfolders").then(function(response){return response.folders},showErrorIfLoaded)},userFolder.inviteUserCall=function(data){return newApiCall("/spotfire/tsc/webservices/inviteuser",data).catch(showError)},userFolder.getFolderUsers=function(editFolderId){return newApiCall("/spotfire/tsc/webservices/getfolderusers",{folderId:editFolderId}).then(function(response){return response.users},showError)},userFolder.updateFolderUsers=function(folderId,users){return newApiCall("/spotfire/tsc/webservices/updatefolderusers",{folderid:folderId,users:users}).catch(function(response){$("#responseText").html(response.error)})},userFolder.makeFoldersPrivate=function(folderArr){return newApiCall("/spotfire/tsc/webservices/removefolder",{folderid:folderArr})},userFolder.makeFoldersPublic=function(folderArr){return newApiCall("/spotfire/tsc/webservices/makefolderpublic",{folderid:folderArr})},userFolder.getfolderitems=function(path){return busy("body"),newApiCall("/spotfire/tsc/webservices/getfolderitems",{folderpath:path}).then(function(folder){return ready("body"),folder},showError)},userFolder}]).service("errorHandler",function(){var msgObject={"/spotfire/tsc/webservices/SyncSalesLead":{500:"server Problem occur",404:"Page Does n't found ,checked whole server"},"wbservices/SyncSalesLead":{500:"server Problem occur",404:"Page1 Does n't found ,checked whole server"}};this.getMessages=function(status,url){return msgObject[url][status]}}),angular.module("masterModule").controller("LibraryCtrl",["$scope","$rootScope","$location","cloudService","userFolder","$routeParams",function($scope,$rootScope,$location,cloudService,userFolder,$routeParams){function getInfoDialogMessage(folder){switch(folder.type){case"public":return"This folder is public, which means it can be accessed by anyone with web access who clicks on the following URL. Access to this folder and its data does not require a Spotfire Cloud account:";case"shared":return"This folder is shared, which means it can only be accessed by logged-in Spotfire Cloud users whom you have specifically shared it with. Folder URL:";case"private":return"This folder is only accessible by you. The link below will only work for you:";default:return""}}$scope.createFolder=!1,$scope.myFolders={},$scope.myFolderUsers={},$scope.publicFolders={},$scope.mySharedFolders={},$scope.sharedWithMeFolders={},$scope.folderName={},$scope.subFolders={},$scope.folderHierarchy={},$scope.currentfolder={},$scope.selectedFolderName=[],$scope.selectedFolder=[],$scope.selectedFolderId=[],$scope.userToAdd="",$scope.forgetemail="",$scope.editFolderId="",$scope.folderUsers={},$scope.allFolderUsers={},$scope.areAllSelectedDialog=!1,$scope.selectedPublicFolderId=[],$scope.selectedPrivateFolderId=[],$scope.inviteUserId={},$scope.hasWorkgroupFolder=!1,$scope.iframeSrc="",$scope.areAllSelected=!1,$scope.action="action",$scope.sortDescending=!1,$scope.sharePagechk=!1,$scope.inviteUserEmail="",$scope.invitationMessage="",$scope.myFolderUsersChange=!1,$scope.anonymousSharedFolderList={},cloudService.getCurrentUser.then(function(currentUser){$scope.currentUser=currentUser,$scope.hasWorkgroupFolder=currentUser.hasWorkgroupFolder===!0?!0:!1,currentUser.loggedIn?$rootScope.selectedLink=$location.path().replace("/",""):(!$rootScope||$rootScope.returnUrl&&0!=$rootScope.returnUrl.length||($rootScope.returnUrl=window.location.href),$location.path("signin").search("returnUrl",$rootScope.returnUrl))}),$scope.folderTypeFilter=function(string){switch(string){case"public":string="Public";break;case"private":string="Private";break;case"shared":string="Shared";break;case"sharedwithme":string="Shared With Me";break;case"workgroup":string="Work Group";break;default:string=string}return string},$scope.equalsPublic=function(param){return"Public"!=param.title?param:null},$scope.wizardBack=function(show,hide){$("#"+hide).hide(),$("#"+show).show()},$scope.changeSorting=function(){$scope.sortDescending=$scope.sortDescending?!1:!0};var showModal=function(id){var elem=$("#"+id),body=$("body");return elem.on("show.bs.modal",function(){body.addClass("twbs")}),elem.on("hidden.bs.modal",function(){body.removeClass("twbs"),elem.off("show.bs.modal"),elem.off("hidden.bs.modal")}),elem.modal("show")};$scope.showInviteUsersModal=function(folder){$scope.inviteUsersForm.inviteUserEmail.$dirty=!1,$scope.inviteUserEmail="",$scope.invitationMessage="",$("#inviteUsersModal").data("folderid",folder.id),showModal("inviteUsersModal")},$scope.showFolderInfoDialog=function(folder){var message=getInfoDialogMessage(folder);$("#folderInfoDialogMessage").html(message);var url=folder.url;$("#folderInfoDialogContent").val(url),showModal("folderInfoDialog")},$scope.inviteUserCall=function(){if($scope.inviteUsersForm.$valid){var folderid=$("#inviteUsersModal").data("folderid"),inviteEmails=$scope.inviteUserEmail.split(",");userFolder.inviteUserCall({folderid:folderid,email:inviteEmails,message:$scope.invitationMessage}).then(function(){$scope.wizardBack("inviteUsersSuccess","inviteUsersContent"),$scope.updateAllFolders()})}else $scope.inviteUsersForm.inviteUserEmail.$invalid=!0,$scope.inviteUsersForm.inviteUserEmail.$dirty=!0},$scope.areFoldersSelected=function(folders){var returnFlag=!1;return $.each(folders,function(index,item){(item.isSelected||"active"==item.isSelected)&&(returnFlag=!0)}),returnFlag},$scope.toggleSelection=function(folder,section){switch(folder.isSelected=folder.isSelected||"active"==folder.isSelected?"":"active",section){case"public":$scope.areFoldersSelected($scope.publicFolders)?$("#makePrivateFoldersButton").show():$("#makePrivateFoldersButton").hide();break;case"sharedfolders":$scope.areFoldersSelected($scope.mySharedFolders)?$(".mySharedFoldersTd").show():$(".mySharedFoldersTd").hide();break;case"sharedwithme":$scope.areFoldersSelected($scope.sharedWithMeFolders)?$("#sharedWithMeActionRow").show():$("#sharedWithMeActionRow").hide()}},$scope.resetMiniBrowser=function(){$("#publicShareWidget").hide(),$("#myShareWidget").hide(),$scope.selectedFolderName=[],$scope.selectedFolderId=[],$scope.currentfolder=$scope.myFolders},$scope.backTrackFolder=function(id){$.each($scope.selectedFolderName,function(index,item){return item.id==id?($scope.selectedFolderName.splice(index+1,$scope.selectedFolderName.length-index),$scope.selectedFolderId.splice(index+1,$scope.selectedFolderName.length-index),!1):!0});var hierarchy=$scope.folderHierarchy;$.each($scope.selectedFolderName,function(index,item){hierarchy=hierarchy[item.id].subfolders}),$scope.currentfolder=hierarchy},$scope.showHideWizard3=function(show,hide1,hide2){$("#"+show).show(),$("#"+hide1).hide(),$("#"+hide2).hide()},$scope.showEditUsers=function(folder){$scope.inviteUserId=folder.id},$scope.displayMyEditSuccess=function(){$scope.inviteUserForm.$valid?$scope.inviteUserApiCall():($scope.inviteUserForm.inviteUserEmail.$invalid=!0,$scope.inviteUserForm.inviteUserEmail.$dirty=!0)},$scope.inviteUserApiCall=function(){var inviteEmails=$scope.inviteUserEmail.split(",");userFolder.inviteUserCall({folderid:$scope.inviteUserId,email:inviteEmails,message:$scope.invitationMessage}).then(function(){$scope.showHideWizard3("myEditSuccess","myShareContent","myEditContent"),$scope.updateAllFolders()},function(){$("#fileDialogMySharedModal").modal("hide"),showModal("inviteUsersModal")})},$scope.showMySharedFolderEditDialog=function(editFolderId){$scope.editFolderId=editFolderId,getFolderUsers($scope.editFolderId)},$scope.getHomeFolder=function(){userFolder.getHomeFolder()},$scope.getWorkGroupFolder=function(){userFolder.getWorkGroupFolder()},$scope.addFolder=function(){userFolder.addFolder(folderName)};var showSpinner=function(){$scope.loadingSpinnerVisible=!0},hideSpinner=function(){$scope.loadingSpinnerVisible=!1};$scope.getMyFolders=function(){showSpinner(),$scope.areAllSelectedDialog=!1,userFolder.getMyFolders().then(function(folders){$scope.myFolders=folders}).finally(hideSpinner)};var getFolderUsers=function(editFolderId){userFolder.getFolderUsers(editFolderId).then(function(users){$scope.myFolderUsers=users,$scope.myFolderUsersChange=!1})};$scope.getSubFolders=function(parentId){$("#publicShareWidget").show(),$("#myShareWidget").show();var showView=function(response){var hierarchy=$scope.folderHierarchy;$scope.currentfolder=response.subfolders,$.each($scope.selectedFolderName,function(index,item){hierarchy=hierarchy[item.id].subfolders}),hierarchy[parentId].subfolders=folderArrayToJson(response.subfolders),$scope.selectedFolderName.push({id:parentId,title:hierarchy[parentId].title})};userFolder.getSubFolders(showView,parentId)},$scope.resetField=function(){$scope.userToAdd=""},$scope.addFolderRow=function(){if(""!=$scope.userToAdd){if($scope.addUserForm.userToAdd.$error.email)return void $scope.addUserForm.userToAdd.$setValidity("emailinvalid",!1);$scope.addUserForm.userToAdd.$setValidity("emailinvalid",!0),$scope.myFolderUsersChange=!0,$scope.myFolderUsers.push($scope.userToAdd),$scope.resetField()}},$scope.deleteFolderRow=function(usr){$scope.myFolderUsersChange=!0,$.each($scope.myFolderUsers,function(index,user){user==usr&&$scope.myFolderUsers.splice(index,1)})},$scope.showRemoveUserConfirmation=function(){$scope.areAllSelectedDialog||$('.removeUserRow input[type="checkbox"]').length==$('.removeUserRow input[type="checkbox"]:checked').length?($("#fileDialogMySharedEditModal").off("hidden.bs.modal"),$("#fileDialogMySharedEditModal").modal("hide"),$scope.makeFoldersPrivate({id:$scope.editFolderId,allCheckFlag:!0},"Stop Sharing?")):($("#mySharedEditContent .modal-header .product-column").html("Remove these Users?"),$("#userList").hide(),$("#confirmationDialog").show())},$scope.showEditUserDialog=function(folder){$scope.areAllSelectedDialog=!1,$.each($('#removeUserRow input[type="checkbox"]'),function(index,item){$(item).prop("checked",!1)}),$scope.editFolderId=folder.id,getFolderUsers($scope.editFolderId),$("#mySharedEditContent .modal-header .product-column").html("Remove Users"),$("#userList").show(),$("#confirmationDialog").hide(),$("#responseText").hide(),showModal("fileDialogMySharedEditModal"),$scope.myFolderUsersChange=!1},$scope.updateFolderUsersApiCall=function(){var selectedUsers=$(".folder_users:checked");$.each(selectedUsers,function(index,user){$scope.deleteFolderRow($(user).val())});var folderId=$scope.editFolderId,users=$scope.myFolderUsers,updateAllFolders=$scope.updateAllFolders;userFolder.updateFolderUsers(folderId,users,updateAllFolders).then(function(){$("#responseText").html('<p class="font20">Users have now been removed.</p><p class="text-right"><button type="button" class="btn blue-button" data-dismiss="modal">OK</button></p>').show(),$("#confirmationDialog").hide()})},$scope.makeFoldersPrivate=function(folder,header){var selectedFolders=[folder.id];$("#confirmationModal").data("id",selectedFolders),folder.allCheckFlag&&$("#confirmationModal").css("overflow-y","auto"),$("#confirmationModal .modal-header").html('<button aria-hidden="true" data-dismiss="modal" class="close" type="button">&times;</button><h2 class="modal-title modal-title-customized">'+header+"</h2>"),$("#confirmationModal .modal-body").html('<p class="font17"> Your content will no longer be available to other users.</p><p class="text-right"><button type="button" id="makePrivateButton" class="btn blue-button m10">OK</button>&nbsp;<button type="button" class="btn btn-default gray-button" data-dismiss="modal">Cancel</button></p>');var button=$("#makePrivateButton");button.click($scope.makeFoldersPrivateApiCall),showModal("confirmationModal").css("z-index","4000")},$scope.makeFoldersPrivateApiCall=function(){var folders=$("#confirmationModal").data("id");userFolder.makeFoldersPrivate(folders).then(function(){$scope.updateAllFolders(),$("#confirmationModal .modal-body").html('<p class="font20"> Folder is no longer shared with any other than you. </p><p class="text-center"><button type="button" class="btn blue-button m10" data-dismiss="modal">OK</button></p>')},function(response){$("#confirmationModal .modal-body").html(response.error)})},$scope.makeFoldersPublic=function(folder){var selectedFolders=[folder.id];$("#confirmationModal").data("id",selectedFolders),$("#confirmationModal .modal-header").html('<button aria-hidden="true" data-dismiss="modal" class="close" type="button">&times;</button><h2 class="modal-title modal-title-customized">Make Public?</h2>'),$("#confirmationModal .modal-body").html('<p class="font17">Your content will be publicly available on the web.</p><p class="text-right"><button id="makePublicButton" type="button" class="btn blue-button"><b>OK</b></button>&nbsp;<button type="button" class="btn btn-default gray-button" data-dismiss="modal">Cancel</button></p>');var button=$("#makePublicButton");button.click($scope.makePublicFoldersApiCall),showModal("confirmationModal").css("z-index","4000")},$scope.makePublicFoldersApiCall=function(){var folders=$("#confirmationModal").data("id");userFolder.makeFoldersPublic(folders).then(function(){$scope.updateAllFolders(),$("#confirmationModal .modal-body").html('<p class="font20"> Folder is now publicly available on the web. </p><p class="text-center"><button type="button" class="btn blue-button m10" data-dismiss="modal">OK</button></p>')},function(response){$("#confirmationModal .modal-body").html(response.error)})},$scope.openFolder=function(folder){window.location=folder.url},$scope.updateAllFolders=function(){$scope.getMyFolders()},$scope.getLibraryContent=function(){$scope.iframeSrc=$scope.currentUser.libraryBrowserBase+$routeParams.folder,$("#LibraryContent iframe").on("load",function(){this.style.height=this.contentWindow.document.body.scrollHeight+100+"px"})},$scope.folderselectedItem=function(checkboxValue,folder){folder.isSelected=checkboxValue?!1:!0},$scope.selectAll=function(){$.each($('#userList input[type="checkbox"]'),function(index,item){$(item).prop("checked",$scope.areAllSelectedDialog)})},$scope.getSelectedActionItem=function(folder,a){$scope[a](folder)}}]),angular.module("masterModule").directive("emailList",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attr,control){element.bind("blur",function(){for(var value=element.val(),result=value.split(","),count=0,_validityFlag=!0,i=0;i<result.length;i++)_validityFlag=/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,3}/.test(result[i]),_validityFlag===!1&&(count+=1);count>0&&(_validityFlag=!1);var _chkLastChar=!0;","==value[value.length-1]&&(_chkLastChar=!1),scope.$apply(function(){control.$setValidity("emaillistchk",_validityFlag),control.$setValidity("emaillastchar",_chkLastChar)})})}}});
//# sourceMappingURL=/src/tsc/js/customization/customization.min.map